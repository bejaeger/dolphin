Adapted from https://github.com/karpathy/nanoGPT/tree/master